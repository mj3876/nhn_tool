<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚ ì”¨</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .weather-container {
            max-width: 800px;
            margin: 30px auto;
            text-align: center;
        }
        
        .weather-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .weather-icon {
            font-size: 5em;
            margin: 20px 0;
        }
        
        .temperature {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .weather-status {
            font-size: 1.5em;
            margin-bottom: 30px;
        }
        
        .weather-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .info-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .update-time {
            margin-top: 20px;
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .loading {
            display: none;
            padding: 40px;
            font-size: 1.2em;
        }
        
        .error {
            display: none;
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .refresh-btn {
            background: white;
            color: #667eea;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .refresh-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ¤ï¸ ì‹¤ì‹œê°„ ë‚ ì”¨ ì •ë³´</h1>
        
        <div class="nav">
            <a href="{{ url_for('index') }}" class="nav-btn">ğŸ  í™ˆ</a>
        </div>
        
        <div class="weather-container">
            <!-- ë¡œë”© ì¤‘ -->
            <div id="loading" class="loading">
                â³ ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
            </div>
            
            <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
            <div id="error" class="error">
                <strong>ì˜¤ë¥˜ ë°œìƒ!</strong>
                <p id="error-message"></p>
            </div>
            
            <!-- ë‚ ì”¨ ì •ë³´ -->
            <div id="weather-card" class="weather-card" style="display: none;">
                <h2>ì „êµ­ ë‚ ì”¨</h2>
                <div class="weather-icon" id="weather-icon">â˜€ï¸</div>
                <div class="temperature" id="temperature">--Â°C</div>
                <div class="weather-status" id="weather-status">ë‚ ì”¨ ì •ë³´ ë¡œë”© ì¤‘...</div>
                
                <div class="weather-info">
                    <div class="info-item">
                        <div class="info-label">ìŠµë„</div>
                        <div class="info-value" id="humidity">--%</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">í’ì†</div>
                        <div class="info-value" id="wind-speed">-- m/s</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ê°•ìˆ˜ëŸ‰</div>
                        <div class="info-value" id="rainfall">-- mm</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ë‚ ì”¨</div>
                        <div class="info-value" id="weather-desc">--</div>
                    </div>
                </div>
                
                <div class="update-time" id="update-time">ì—…ë°ì´íŠ¸: --</div>
                
                <button class="refresh-btn" onclick="loadWeather()">
                    ğŸ”„ ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
            
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                <p style="color: #666; font-size: 0.9em;">
                    ğŸ’¡ <strong>ì•ˆë‚´:</strong> í•œêµ­ë„ë¡œê³µì‚¬ ê³ ì†ë„ë¡œ íœ´ê²Œì†Œ ë‚ ì”¨ APIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.<br>
                    API í‚¤: 1663676750<br>
                    ë°ì´í„°ëŠ” ë§¤ì‹œê°„ ì •ì‹œì— ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </div>
    
    <script>
        // ë‚ ì”¨ ì •ë³´ ë¡œë“œ
        function loadWeather() {
            // UI ì´ˆê¸°í™”
            document.getElementById('loading').style.display = 'block';
            document.getElementById('weather-card').style.display = 'none';
            document.getElementById('error').style.display = 'none';
            
            // API í˜¸ì¶œ
            fetch('/api/weather')
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(err => Promise.reject(err));
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('ë‚ ì”¨ ë°ì´í„°:', data);
                    
                    // ë¡œë”© ìˆ¨ê¸°ê¸°
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('weather-card').style.display = 'block';
                    
                    // ë°ì´í„° í‘œì‹œ
                    document.getElementById('weather-icon').textContent = data.icon;
                    document.getElementById('temperature').textContent = Math.round(data.temperature) + 'Â°C';
                    document.getElementById('weather-status').textContent = data.status;
                    document.getElementById('humidity').textContent = data.humidity + '%';
                    document.getElementById('wind-speed').textContent = data.wind_speed + ' m/s';
                    document.getElementById('rainfall').textContent = data.rainfall + ' mm';
                    document.getElementById('weather-desc').textContent = data.weather || 'ì •ë³´ì—†ìŒ';
                    document.getElementById('update-time').textContent = 'ì—…ë°ì´íŠ¸: ' + data.update_time;
                })
                .catch(error => {
                    console.error('ë‚ ì”¨ API ì˜¤ë¥˜:', error);
                    
                    // ë¡œë”© ìˆ¨ê¸°ê¸°
                    document.getElementById('loading').style.display = 'none';
                    
                    // ì—ëŸ¬ í‘œì‹œ
                    document.getElementById('error').style.display = 'block';
                    document.getElementById('error-message').textContent = 
                        error.error || 'ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                });
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë‚ ì”¨ í‘œì‹œ
        window.addEventListener('load', function() {
            loadWeather();
        });
        
        // 5ë¶„ë§ˆë‹¤ ìë™ ê°±ì‹ 
        setInterval(loadWeather, 300000);
    </script>
</body>
</html>